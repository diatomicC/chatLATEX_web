<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>LaTeX Chat</title>
  <link rel="stylesheet" type="text/css" href="style.css">
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async
          src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
  </script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.2/html2canvas.min.js"></script>
  <script src="script.js"></script>
</head>

<body>
  <div id="translate">
  <button id="btn-en">English</button> <button id="btn-ko">한국어</button>
  </div>
  <div id="get_api_key">
    <span id="locale" style="display: none"></span>
    <div>
    <div id="api_key_text">
      <!-- <h4>개인이 소유하고 있는 ChatGPT API 키가 있어야 하는 서비스입니다. <br>API 키를 발급 받으시려면 아래의 링크로 들어가주세요.(회원가입 필요)</h4>-->
      <pre><h4 id="comment" data-lang="comment">[comment]</h4></pre>
    </div>
    <div id="api_key_button">
      <a href="https://platform.openai.com/account/api-keys" target="_blank" data-lang="api_key_button">[api_key_button]</a>
    </div>
  </div>
    <hr>
  </div>

  <style>
    #api_key_text {
      display: inline-block;
      vertical-align: top;
    }

    #api_key_button {
      display: inline-block;
      margin-left: 40px;
    }
  </style>

  <div id="input-container">
    <label id='label' for="api_key" data-lang="api_key">API 키: </label>
    <input type="text"  id="api_key" name="api_key" placeholder="Type your own API key here..." name="api_key" required />
  </div>
  <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
  <div id="input-container">
    <label id='label' for="api_key" data-lang="equation">수식입력 : </label>
    <input type="text" id="chat-input" placeholder="Type your message here..."
      onkeydown="if(event.keyCode===13) search()">
    <button id="submit-btn" onclick="search()">Send</button>
  </div>
  <div id="chat-window">
    <div class="message-container system-message" id="latex">
      <p>You are a LaTeX expert.</p>
    </div>
  </div>
  <script>
    // 언어별 JSON 파일 (간략화)
    const lang = {
        ko: {
            comment: "ChatGPT를 통해 원하는 공식을 LATEX와 수식이미지로 변환하는 사이트입니다. \n 바꾸기를 원하는 공식을 수식입력창에 넣어주세요. \n EX) 근의 공식, 라플라스 변환 \n\n 개인이 소유하고 있는 ChatGPT API 키가 있어야 하는 서비스입니다.\n API 키를 발급 받으시려면 아래의 링크로 들어가주세요.(회원가입 필요)",
            api_key_button: "API 발급 받기",
            api_key: "API 키: ",
            equation:"수식입력:"
        },
        en: {
            comment: "This is a site that converts desired formulas into LATEX and formula images through ChatGPT. \n Enter the formula you want to replace in the formula bar. \n EX) Root formula, Laplace transform \n\nThis service requires a ChatGPT API key owned by an individual.\nTo get an API key, please enter the link below (registration required).",
            api_key_button: "Get an API Key",
            api_key: "API Key: ",
            equation:"Enter a formula:"
        }
    }

    // ** 현재 브라우저의 언어 가져오기 **
    function getLanguage() {
        return navigator.language || navigator.userLanguage;
    }

    // 언어별 적용
    function init(localeStr) {
        document.getElementById("locale").textContent = localeStr
    }

    // 초기 작업
    const currentLang = getLanguage()
    init(currentLang)
    render(currentLang.substr(0, 2))

    // 언어별 렌더링
    function render(locale) {
        const $lang = document.querySelectorAll("[data-lang]")
        $lang.forEach(el => {
            const code = el.dataset.lang
            el.textContent = lang[locale][code]
        })
    }

    // 버튼 이벤트
    document.getElementById("btn-en").addEventListener("click", e => {
        render("en")
    })
    document.getElementById("btn-ko").addEventListener("click", e => {
        render("ko")
    })
</script>
</body>
</html>
